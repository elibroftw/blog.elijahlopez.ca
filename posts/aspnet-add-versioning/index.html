<!DOCTYPE html>
<html lang="en" data-theme="">
<head>
    
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name = "apple-mobile-web-app-capable" content = "yes">
    <meta name="theme-color" content="#121212">

    <meta charset="utf-8">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <title>ASP.NET Core Add Versioning to Endpoints - ELL Blog</title>
    <meta name="description" content="A tutorial on adding API versioning to ASP.NET Core endpoints for .NET 8 and .NET 9, covering setup with OpenAPI/Scalar and Swagger, and providing code examples for implementation.">
    
    <link rel="icon" type="image/x-icon" href="https://blog.elijahlopez.ca/favicon.ico">
    <link rel="apple-touch-icon-precomposed" href="https://blog.elijahlopez.ca/favicon.png">

    <link rel="stylesheet" href="https://blog.elijahlopez.ca/css/style.min.a3636fe363937f82d02cf99304911d0408aab8e9cb1849af08144cfcedc2e758.css" integrity="sha256-o2Nv42OTf4LQLPmTBJEdBAiquOnLGEmvCBRM/O3C51g=">
    <script src="https://blog.elijahlopez.ca/js/script.min.74bf1a3fcf1af396efa4acf3e660e876b61a2153ab9cbe1893ac24ea6d4f94ee.js" type="text/javascript" charset="utf-8" integrity="sha256-dL8aP88a85bvpKzz5mDodrYaIVOrnL4Yk6wk6m1PlO4="></script>
    <meta property="og:url" content="https://blog.elijahlopez.ca/posts/aspnet-add-versioning/">
  <meta property="og:site_name" content="ELL Blog">
  <meta property="og:title" content="ASP.NET Core Add Versioning to Endpoints">
  <meta property="og:description" content="A tutorial on adding API versioning to ASP.NET Core endpoints for .NET 8 and .NET 9, covering setup with OpenAPI/Scalar and Swagger, and providing code examples for implementation.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-07T02:05:53-05:00">
    <meta property="article:modified_time" content="2024-03-07T02:05:53-05:00">
    <meta property="article:tag" content="Programming">
    <meta property="article:tag" content="Tutorial">
    <meta property="article:tag" content="C-Sharp">
    <meta property="article:tag" content="Asp.net">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="ASP.NET Core Add Versioning to Endpoints">
  <meta name="twitter:description" content="A tutorial on adding API versioning to ASP.NET Core endpoints for .NET 8 and .NET 9, covering setup with OpenAPI/Scalar and Swagger, and providing code examples for implementation.">

    
    <script src="https://ryb.elijahlopez.ca/api/script.js" data-site-id="1" defer></script>
</head>


<body>
    <a class="skip-main" href="#main">Skip to main content</a>
    <div class="container">
        <header class="common-header">
            
                

    


<div class="header-top">
    <h1 class="site-title">
        <a href="/">ELL Blog</a>
    </h1>

    <div class="header-top-left">
    <ul class="social-icons">

        <li>
            <a href="/index.xml" title="Rss" rel="me">
                <span class="inline-svg" >
                    
                </span>

            </a>
        </li>
    
<li>
            <a href="https://elijahlopez.ca" title="Website" rel="me">
            <span class="inline-svg" >
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M352 256C352 278.2 350.8 299.6 348.7 320H163.3C161.2 299.6 159.1 278.2 159.1 256C159.1 233.8 161.2 212.4 163.3 192H348.7C350.8 212.4 352 233.8 352 256zM503.9 192C509.2 212.5 512 233.9 512 256C512 278.1 509.2 299.5 503.9 320H380.8C382.9 299.4 384 277.1 384 256C384 234 382.9 212.6 380.8 192H503.9zM493.4 160H376.7C366.7 96.14 346.9 42.62 321.4 8.442C399.8 29.09 463.4 85.94 493.4 160zM344.3 160H167.7C173.8 123.6 183.2 91.38 194.7 65.35C205.2 41.74 216.9 24.61 228.2 13.81C239.4 3.178 248.7 0 256 0C263.3 0 272.6 3.178 283.8 13.81C295.1 24.61 306.8 41.74 317.3 65.35C328.8 91.38 338.2 123.6 344.3 160H344.3zM18.61 160C48.59 85.94 112.2 29.09 190.6 8.442C165.1 42.62 145.3 96.14 135.3 160H18.61zM131.2 192C129.1 212.6 127.1 234 127.1 256C127.1 277.1 129.1 299.4 131.2 320H8.065C2.8 299.5 0 278.1 0 256C0 233.9 2.8 212.5 8.065 192H131.2zM194.7 446.6C183.2 420.6 173.8 388.4 167.7 352H344.3C338.2 388.4 328.8 420.6 317.3 446.6C306.8 470.3 295.1 487.4 283.8 498.2C272.6 508.8 263.3 512 255.1 512C248.7 512 239.4 508.8 228.2 498.2C216.9 487.4 205.2 470.3 194.7 446.6H194.7zM190.6 503.6C112.2 482.9 48.59 426.1 18.61 352H135.3C145.3 415.9 165.1 469.4 190.6 503.6V503.6zM321.4 503.6C346.9 469.4 366.7 415.9 376.7 352H493.4C463.4 426.1 399.8 482.9 321.4 503.6V503.6z"/></svg>
                </span>

            </a>
        </li>
    

        
        
        <li>
            <a href="https://github.com/elibroftw" title="Github" rel="me">
            <span class="inline-svg" >
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
                </span>

            </a>
        </li>
    

        
        
        <li>
            <a href="https://twitter.com/elibroftw" title="Twitter" rel="me">
            <span class="inline-svg" >
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
                </span>

            </a>
        </li>
    

        
        
        <li>
            <a href="https://www.youtube.com/c/elibroftw" title="Youtube" rel="me">
            <span class="inline-svg" >
                    <svg viewBox="0 -3 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg"
  xmlns:xlink="http://www.w3.org/1999/xlink">
  <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
    <g id="Dribbble-Light-Preview" transform="translate(-300.000000, -7442.000000)" fill="#000000">
      <g id="icons" transform="translate(56.000000, 160.000000)">
        <path fill="currentColor"
          d="M251.988432,7291.58588 L251.988432,7285.97425 C253.980638,7286.91168 255.523602,7287.8172 257.348463,7288.79353 C255.843351,7289.62824 253.980638,7290.56468 251.988432,7291.58588 M263.090998,7283.18289 C262.747343,7282.73013 262.161634,7282.37809 261.538073,7282.26141 C259.705243,7281.91336 248.270974,7281.91237 246.439141,7282.26141 C245.939097,7282.35515 245.493839,7282.58153 245.111335,7282.93357 C243.49964,7284.42947 244.004664,7292.45151 244.393145,7293.75096 C244.556505,7294.31342 244.767679,7294.71931 245.033639,7294.98558 C245.376298,7295.33761 245.845463,7295.57995 246.384355,7295.68865 C247.893451,7296.0008 255.668037,7296.17532 261.506198,7295.73552 C262.044094,7295.64178 262.520231,7295.39147 262.895762,7295.02447 C264.385932,7293.53455 264.28433,7285.06174 263.090998,7283.18289"
          id="youtube-[#168]">
        </path>
      </g>
    </g>
  </g>
</svg>

                </span>

            </a>
        </li>
    

        
        
        <li>
            <a href="mailto:elijahllopezz@gmail.com" title="Email" rel="me">
            <span class="inline-svg" >
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4L236.8 313.6c11.4 8.5 27 8.5 38.4 0L492.8 150.4c12.1-9.1 19.2-23.3 19.2-38.4c0-26.5-21.5-48-48-48L48 64zM0 176L0 384c0 35.3 28.7 64 64 64l384 0c35.3 0 64-28.7 64-64l0-208L294.4 339.2c-22.8 17.1-54 17.1-76.8 0L0 176z"/></svg>

                </span>

            </a>
        </li>
    

        
        
        <li>
            <a href="https://www.instagram.com/elijahllopezz" title="Instagram" rel="me">
            <span class="inline-svg" >
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18ZM12 16C14.2091 16 16 14.2091 16 12C16 9.79086 14.2091 8 12 8C9.79086 8 8 9.79086 8 12C8 14.2091 9.79086 16 12 16Z" fill="#0F0F0F"/>
<path fill="currentColor" d="M18 5C17.4477 5 17 5.44772 17 6C17 6.55228 17.4477 7 18 7C18.5523 7 19 6.55228 19 6C19 5.44772 18.5523 5 18 5Z" fill="#0F0F0F"/>
<path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M1.65396 4.27606C1 5.55953 1 7.23969 1 10.6V13.4C1 16.7603 1 18.4405 1.65396 19.7239C2.2292 20.8529 3.14708 21.7708 4.27606 22.346C5.55953 23 7.23969 23 10.6 23H13.4C16.7603 23 18.4405 23 19.7239 22.346C20.8529 21.7708 21.7708 20.8529 22.346 19.7239C23 18.4405 23 16.7603 23 13.4V10.6C23 7.23969 23 5.55953 22.346 4.27606C21.7708 3.14708 20.8529 2.2292 19.7239 1.65396C18.4405 1 16.7603 1 13.4 1H10.6C7.23969 1 5.55953 1 4.27606 1.65396C3.14708 2.2292 2.2292 3.14708 1.65396 4.27606ZM13.4 3H10.6C8.88684 3 7.72225 3.00156 6.82208 3.0751C5.94524 3.14674 5.49684 3.27659 5.18404 3.43597C4.43139 3.81947 3.81947 4.43139 3.43597 5.18404C3.27659 5.49684 3.14674 5.94524 3.0751 6.82208C3.00156 7.72225 3 8.88684 3 10.6V13.4C3 15.1132 3.00156 16.2777 3.0751 17.1779C3.14674 18.0548 3.27659 18.5032 3.43597 18.816C3.81947 19.5686 4.43139 20.1805 5.18404 20.564C5.49684 20.7234 5.94524 20.8533 6.82208 20.9249C7.72225 20.9984 8.88684 21 10.6 21H13.4C15.1132 21 16.2777 20.9984 17.1779 20.9249C18.0548 20.8533 18.5032 20.7234 18.816 20.564C19.5686 20.1805 20.1805 19.5686 20.564 18.816C20.7234 18.5032 20.8533 18.0548 20.9249 17.1779C20.9984 16.2777 21 15.1132 21 13.4V10.6C21 8.88684 20.9984 7.72225 20.9249 6.82208C20.8533 5.94524 20.7234 5.49684 20.564 5.18404C20.1805 4.43139 19.5686 3.81947 18.816 3.43597C18.5032 3.27659 18.0548 3.14674 17.1779 3.0751C16.2777 3.00156 15.1132 3 13.4 3Z" fill="#0F0F0F"/>
</svg>

                </span>

            </a>
        </li>
    



    <li>
            <a href="https://blog.elijahlopez.ca/index.xml" title="RSS" rel="me"><span class="inline-svg" >
                    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" data-icon="rss" data-prefix="fas" focusable="false" role="img" viewBox="0 0 496 512"><path fill="currentColor" fill="currentColor" d="M128.081 415.959c0 35.369-28.672 64.041-64.041 64.041S0 451.328 0 415.959s28.672-64.041 64.041-64.041 64.04 28.673 64.04 64.041zm175.66 47.25c-8.354-154.6-132.185-278.587-286.95-286.95C7.656 175.765 0 183.105 0 192.253v48.069c0 8.415 6.49 15.472 14.887 16.018 111.832 7.284 201.473 96.702 208.772 208.772.547 8.397 7.604 14.887 16.018 14.887h48.069c9.149.001 16.489-7.655 15.995-16.79zm144.249.288C439.596 229.677 251.465 40.445 16.503 32.01 7.473 31.686 0 38.981 0 48.016v48.068c0 8.625 6.835 15.645 15.453 15.999 191.179 7.839 344.627 161.316 352.465 352.465.353 8.618 7.373 15.453 15.999 15.453h48.068c9.034-.001 16.329-7.474 16.005-16.504z"/></svg>
                </span>
</a>
        </li>
    
</ul>
</div>
    

    




    <div class="header-top-right theme-switcher">
        <span class="inline-svg" >
                    <svg xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 290 290">
<path fill="currentColor" d="M142.959,0C64.131,0,0,64.132,0,142.96c0,78.828,64.131,142.959,142.959,142.959c78.828,0,142.96-64.131,142.96-142.959  C285.919,64.132,221.787,0,142.959,0z M142.959,260.919V142.96V25c65.043,0,117.96,52.917,117.96,117.96  C260.919,208.003,208.002,260.919,142.959,260.919z"/>
</svg>
                </span>

    </div>


<script>
const STORAGE_KEY = 'user-color-scheme'
const defaultTheme = "auto"

let currentTheme
let switchButton
let autoDefinedScheme = window.matchMedia('(prefers-color-scheme: dark)')

const autoChangeScheme = e => {
    currentTheme = e.matches ? 'dark' : 'light'
    document.documentElement.setAttribute('data-theme', currentTheme)
}

document.addEventListener('DOMContentLoaded', function() {
    switchButton = document.querySelector('.theme-switcher')
    currentTheme = detectCurrentScheme()
    setThemeColorMeta(currentTheme)
    if (currentTheme == 'dark') {
        document.documentElement.setAttribute('data-theme', 'dark')
    }

    if (currentTheme == 'auto') {
        autoChangeScheme(autoDefinedScheme);
        autoDefinedScheme.addListener(autoChangeScheme);
    }

    if (switchButton) {
        switchButton.addEventListener('click', switchTheme, false)
    }
})

function detectCurrentScheme() {
    if (localStorage !== null && localStorage.getItem(STORAGE_KEY)) {
        return localStorage.getItem(STORAGE_KEY)
    }
    if (defaultTheme) {
        return defaultTheme
    }
    if (!window.matchMedia) {
        return defaultTheme
    }
    if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        return 'dark'
    }
    return defaultTheme
}

function switchTheme(e) {
    if (currentTheme == 'dark') {
        if (localStorage !== null)
            localStorage.setItem(STORAGE_KEY, 'light')
        document.documentElement.setAttribute('data-theme', 'light')
        currentTheme = 'light'
    } else {
        if (localStorage !== null)
            localStorage.setItem(STORAGE_KEY, 'dark')
        document.documentElement.setAttribute('data-theme', 'dark')
        currentTheme = 'dark'
    }
    setThemeColorMeta(currentTheme)
}

function setThemeColorMeta(currentTheme) {
    if (currentTheme == 'dark') {
        document.querySelector('meta[name="theme-color"]').setAttribute('content', '#121212')
    } else {
        document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
    }
}
</script>

</div>


    <nav>
        
        
        <a class="" href="https://blog.elijahlopez.ca/" title="Home">Home</a>
        
        <a class="" href="https://blog.elijahlopez.ca/posts/" title="Archive">Archive</a>
        
        <a class="" href="https://blog.elijahlopez.ca/graph/" title="Graph">Graph</a>
        
        <a class="" href="https://blog.elijahlopez.ca/tags/" title="Tags">Tags</a>
        
    </nav>






            
        </header>
        <main id="main" tabindex="-1">
            
    

    <article class="post h-entry">
        <div class="post-header">
            <header>
                <h1 class="p-name post-title">ASP.NET Core Add Versioning to Endpoints</h1>
                
            </header>
        </div>
        
        
            
            
            <div class="post-info">
                <ul class="post-authors">
                    <a href="https://blog.elijahlopez.ca/authors/elijah-lopez/">@Elijah Lopez</a>
                </ul>
            </div>
        

        <div class="post-info">
    

    
        <div class="post-date dt-published">
            <a title="2024-03-07 02:05:53 -0500 -0500" class="u-url" href="/posts/aspnet-add-versioning/"><time datetime="2024-03-07">March 7, 2024</time></a>
            
        </div>
    
    <a class="post-hidden-url u-url" href="https://blog.elijahlopez.ca/posts/aspnet-add-versioning/">https://blog.elijahlopez.ca/posts/aspnet-add-versioning/</a>
    <a href="https://blog.elijahlopez.ca/" class="p-name p-author post-hidden-author h-card" rel="me">Elijah Lopez</a>
    <div class="post-taxonomies">
        
        
            <ul class="post-tags">
                
                    
                    <li><a class="tag" href="https://blog.elijahlopez.ca/tags/asp.net/">#Asp.net</a></li>
                
                    
                    <li><a class="tag" href="https://blog.elijahlopez.ca/tags/c-sharp/">#C-Sharp</a></li>
                
                    
                    <li><a class="tag" href="https://blog.elijahlopez.ca/tags/programming/">#Programming</a></li>
                
                    
                    <li><a class="tag" href="https://blog.elijahlopez.ca/tags/tutorial/">#Tutorial</a></li>
                
            </ul>
        
    </div>
</div>

        




        <div class="content e-content">
            <h3 id="introduction" >Introduction
<span>
    <a href="#introduction">
        <svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
    </a>
</span>
</h3><p>Applicable .NET versions: .NET 9, .NET 8.</p>
<ul>
<li>.NET 9 uses OpenAPI and Scaler (Swagger replacement) and requires hardcoding the versions in one file. I have provided a list of packages I installed in my project in case your project is missing a necessary package.</li>
<li>.NET 8 does not need to hardcode the applicable versions, but does use Swagger.</li>
</ul>
<p>This tutorial will save you ~5 hours. I don&rsquo;t know when I started adding API version support to my ASP.NET project, but I can tell you that the current documentation is atrocious if you strive for perfection like I do.</p>
<p>There are two main ways to do API versioning in my eyes. The first way, which is what I thought I would&rsquo;ve added in the future, is to be one of those companies with apis like <code>/v2/my-api</code> but then I found out about header APIs where the client can select the version by using a header. This saves a lot of developing time because all of my endpoints were <code>/name</code> not <code>/v1/name</code> and there were already released/production clients which were calling them without a version specified in the header.</p>
<h3 id="nuget-packages" >NuGet Packages
<span>
    <a href="#nuget-packages">
        <svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
    </a>
</span>
</h3><p>In .NET 9, I needed the following Asp.Versioning packages</p>
<ul>
<li>Asp.Versioning.Http</li>
<li>Asp.Versioning.Http.Client</li>
<li>Asp.Versioning.Mvc.ApiExplorer</li>
<li>Scalar.AspNetCore</li>
</ul>
<p>You can either use VSCode&rsquo;s C# Dev Kit, Visual Studio&rsquo;s Nuget Packages UI, or the dotnet CLI to install these packages. For example, <code>dotnet add &lt;PROJECT&gt; package &lt;PACKAGE_NAME&gt;</code></p>
<p>If you&rsquo;re using Visual Studio, you could also run <code>nuget install Asp.Versioning.Mvc.ApiExplorer</code></p>
<h2 id="net-9-versioning" >.NET 9 Versioning
<span>
    <a href="#net-9-versioning">
        <svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
    </a>
</span>
</h2><p>In .NET 9, we no longer need a ProgramAuxiliary.cs.</p>
<details><summary>OpenApi.Extensions.cs</summary>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cs" data-lang="cs"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">using</span> <span style="color:#447fcf;text-decoration:underline">Asp.Versioning</span>;
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">using</span> <span style="color:#447fcf;text-decoration:underline">Scalar.AspNetCore</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">namespace</span> <span style="color:#447fcf;text-decoration:underline">SttApi</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#6ab825;font-weight:bold">static</span> <span style="color:#6ab825;font-weight:bold">partial</span> <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#447fcf;text-decoration:underline">Extensions</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#6ab825;font-weight:bold">static</span> IApplicationBuilder UseDefaultOpenApi(<span style="color:#6ab825;font-weight:bold">this</span> WebApplication app) {
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">var</span> configuration = app.Configuration;
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">var</span> builder = app.MapOpenApi().CacheOutput();
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">var</span> scalerBuilder = app.MapScalarApiReference(options =&gt; {
</span></span><span style="display:flex;"><span>            <span style="color:#999;font-style:italic">// Disable default fonts to avoid download unnecessary fonts</span>
</span></span><span style="display:flex;"><span>            options.DefaultFonts = <span style="color:#6ab825;font-weight:bold">false</span>;
</span></span><span style="display:flex;"><span>            options.Title = <span style="color:#ed9d13">&#34;Split The Tank API Reference&#34;</span>;
</span></span><span style="display:flex;"><span>            options.EnabledClients = [ScalarClient.Fetch, ScalarClient.HttpClient, ScalarClient.Nsurlsession, ScalarClient.OkHttp];
</span></span><span style="display:flex;"><span>            <span style="color:#999;font-style:italic">// TODO: add default berar</span>
</span></span><span style="display:flex;"><span>            <span style="color:#999;font-style:italic">// TODO: order actions by</span>
</span></span><span style="display:flex;"><span>            <span style="color:#999;font-style:italic">//     options.OrderActionsBy(apiDesc =&gt; {</span>
</span></span><span style="display:flex;"><span>            <span style="color:#999;font-style:italic">//         var priority = apiDesc.ActionDescriptor.RouteValues[&#34;controller&#34;]!.Contains(&#34;Debug&#34;) ? &#34;_&#34; : &#34;&#34;;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#999;font-style:italic">//         return $&#34;{priority}{apiDesc.ActionDescriptor.RouteValues[&#34;controller&#34;]}_{apiDesc.HttpMethod}&#34;;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#999;font-style:italic">//     });</span>
</span></span><span style="display:flex;"><span>            <span style="color:#999;font-style:italic">// .WithHttpBearerAuthentication(bearer =&gt; bearer.Token = &#34;&#34;);</span>
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">if</span> (app.Environment.IsDevelopment()) {
</span></span><span style="display:flex;"><span>            app.MapGet(<span style="color:#ed9d13">&#34;/&#34;</span>, () =&gt; Results.Redirect(<span style="color:#ed9d13">&#34;/scalar/v1&#34;</span>)).ExcludeFromDescription();
</span></span><span style="display:flex;"><span>        } <span style="color:#6ab825;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#999;font-style:italic">// Return 404</span>
</span></span><span style="display:flex;"><span>            builder.RequireAuthorization(<span style="color:#ed9d13">&#34;ApiDeveloperPolicy&#34;</span>);
</span></span><span style="display:flex;"><span>            scalerBuilder.RequireAuthorization  (<span style="color:#ed9d13">&#34;ApiDeveloperPolicy&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">return</span> app;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#6ab825;font-weight:bold">static</span> IHostApplicationBuilder AddDefaultOpenApi(
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">this</span> IHostApplicationBuilder builder,
</span></span><span style="display:flex;"><span>        IApiVersioningBuilder? apiVersioning = <span style="color:#6ab825;font-weight:bold">default</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">var</span> openApi = builder.Configuration.GetSection(<span style="color:#ed9d13">&#34;OpenApi&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">var</span> identitySection = builder.Configuration.GetSection(<span style="color:#ed9d13">&#34;Identity&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">var</span> scopes = identitySection.Exists()
</span></span><span style="display:flex;"><span>            ? identitySection.GetRequiredSection(<span style="color:#ed9d13">&#34;Scopes&#34;</span>).GetChildren().ToDictionary(p =&gt; p.Key, p =&gt; p.Value)
</span></span><span style="display:flex;"><span>            : <span style="color:#6ab825;font-weight:bold">new</span> Dictionary&lt;<span style="color:#6ab825;font-weight:bold">string</span>, <span style="color:#6ab825;font-weight:bold">string?</span>&gt;();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">if</span> (apiVersioning <span style="color:#6ab825;font-weight:bold">is</span> not <span style="color:#6ab825;font-weight:bold">null</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#999;font-style:italic">// the default format will just be ApiVersion.ToString(); for example, 1.0.</span>
</span></span><span style="display:flex;"><span>            <span style="color:#999;font-style:italic">// this will format the version as &#34;&#39;v&#39;major[.minor][-status]&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#6ab825;font-weight:bold">var</span> versioned = apiVersioning.AddApiExplorer(options =&gt; options.GroupNameFormat = <span style="color:#ed9d13">&#34;&#39;v&#39;VVV&#34;</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#999;font-style:italic">// Search code base for [ApiVersion(#.0)]</span>
</span></span><span style="display:flex;"><span>            <span style="color:#6ab825;font-weight:bold">string</span>[] versions = [<span style="color:#ed9d13">&#34;v1&#34;</span>, <span style="color:#ed9d13">&#34;v2&#34;</span>];
</span></span><span style="display:flex;"><span>            <span style="color:#6ab825;font-weight:bold">foreach</span> (<span style="color:#6ab825;font-weight:bold">var</span> description <span style="color:#6ab825;font-weight:bold">in</span> versions) {
</span></span><span style="display:flex;"><span>                builder.Services.AddOpenApi(description, options =&gt; {
</span></span><span style="display:flex;"><span>                    <span style="color:#6ab825;font-weight:bold">if</span> (openApi.Exists()) {
</span></span><span style="display:flex;"><span>                        options.ApplyApiVersionInfo(openApi.GetRequiredValue(<span style="color:#ed9d13">&#34;Document:Title&#34;</span>), openApi.GetRequiredValue(<span style="color:#ed9d13">&#34;Document:Description&#34;</span>));
</span></span><span style="display:flex;"><span>                    }
</span></span><span style="display:flex;"><span>                    options.ApplyAuthorizationChecks([.. scopes.Keys]);
</span></span><span style="display:flex;"><span>                    options.ApplySecuritySchemeDefinitions();
</span></span><span style="display:flex;"><span>                    options.ApplyOperationDeprecatedStatus();
</span></span><span style="display:flex;"><span>                    options.ApplyApiVersionDescription();
</span></span><span style="display:flex;"><span>                    options.ApplySchemaNullableFalse();
</span></span><span style="display:flex;"><span>                    <span style="color:#999;font-style:italic">// Clear out the default servers so we can fallback to</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#999;font-style:italic">// whatever ports have been allocated for the service by Aspire</span>
</span></span><span style="display:flex;"><span>                    options.AddDocumentTransformer((document, context, cancellationToken) =&gt; {
</span></span><span style="display:flex;"><span>                        document.Servers = [];
</span></span><span style="display:flex;"><span>                        <span style="color:#6ab825;font-weight:bold">return</span> Task.CompletedTask;
</span></span><span style="display:flex;"><span>                    });
</span></span><span style="display:flex;"><span>                });
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">return</span> builder;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></details>
<p>This next file also includes Bearer Authentication information which is used by Scalar.</p>
<details><summary>OpenApiOptionsExtensions.cs</summary>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cs" data-lang="cs"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">using</span> <span style="color:#447fcf;text-decoration:underline">System.Text</span>;
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">using</span> <span style="color:#447fcf;text-decoration:underline">Asp.Versioning.ApiExplorer</span>;
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">using</span> <span style="color:#447fcf;text-decoration:underline">Microsoft.AspNetCore.Authorization</span>;
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">using</span> <span style="color:#447fcf;text-decoration:underline">Microsoft.AspNetCore.Mvc.ApiExplorer</span>;
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">using</span> <span style="color:#447fcf;text-decoration:underline">Microsoft.AspNetCore.OpenApi</span>;
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">using</span> <span style="color:#447fcf;text-decoration:underline">Microsoft.Extensions.Configuration</span>;
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">using</span> <span style="color:#447fcf;text-decoration:underline">Microsoft.Extensions.DependencyInjection</span>;
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">using</span> <span style="color:#447fcf;text-decoration:underline">Microsoft.Extensions.Primitives</span>;
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">using</span> <span style="color:#447fcf;text-decoration:underline">Microsoft.OpenApi.Any</span>;
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">using</span> <span style="color:#447fcf;text-decoration:underline">Microsoft.OpenApi.Models</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">namespace</span> <span style="color:#447fcf;text-decoration:underline">SttApi</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">internal</span> <span style="color:#6ab825;font-weight:bold">static</span> <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#447fcf;text-decoration:underline">OpenApiOptionsExtensions</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#6ab825;font-weight:bold">static</span> OpenApiOptions ApplyApiVersionInfo(<span style="color:#6ab825;font-weight:bold">this</span> OpenApiOptions options, <span style="color:#6ab825;font-weight:bold">string</span> title, <span style="color:#6ab825;font-weight:bold">string</span> description)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        options.AddDocumentTransformer((document, context, cancellationToken) =&gt;
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#6ab825;font-weight:bold">var</span> versionedDescriptionProvider = context.ApplicationServices.GetService&lt;IApiVersionDescriptionProvider&gt;();
</span></span><span style="display:flex;"><span>            <span style="color:#6ab825;font-weight:bold">var</span> apiDescription = versionedDescriptionProvider?.ApiVersionDescriptions
</span></span><span style="display:flex;"><span>                .SingleOrDefault(description =&gt; description.GroupName == context.DocumentName);
</span></span><span style="display:flex;"><span>            <span style="color:#6ab825;font-weight:bold">if</span> (apiDescription <span style="color:#6ab825;font-weight:bold">is</span> <span style="color:#6ab825;font-weight:bold">null</span>)
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                <span style="color:#6ab825;font-weight:bold">return</span> Task.CompletedTask;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            document.Info.Version = apiDescription.ApiVersion.ToString();
</span></span><span style="display:flex;"><span>            document.Info.Title = title;
</span></span><span style="display:flex;"><span>            document.Info.Description = BuildDescription(apiDescription, description);
</span></span><span style="display:flex;"><span>            <span style="color:#6ab825;font-weight:bold">return</span> Task.CompletedTask;
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">return</span> options;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">private</span> <span style="color:#6ab825;font-weight:bold">static</span> <span style="color:#6ab825;font-weight:bold">string</span> BuildDescription(ApiVersionDescription api, <span style="color:#6ab825;font-weight:bold">string</span> description)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">var</span> text = <span style="color:#6ab825;font-weight:bold">new</span> StringBuilder(description);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">if</span> (api.IsDeprecated)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#6ab825;font-weight:bold">if</span> (text.Length &gt; <span style="color:#3677a9">0</span>)
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                <span style="color:#6ab825;font-weight:bold">if</span> (text[^<span style="color:#3677a9">1</span>] != <span style="color:#ed9d13">&#39;.&#39;</span>)
</span></span><span style="display:flex;"><span>                {
</span></span><span style="display:flex;"><span>                    text.Append(<span style="color:#ed9d13">&#39;.&#39;</span>);
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                text.Append(<span style="color:#ed9d13">&#39; &#39;</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            text.Append(<span style="color:#ed9d13">&#34;This API version has been deprecated.&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">if</span> (api.SunsetPolicy <span style="color:#6ab825;font-weight:bold">is</span> { } policy)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#6ab825;font-weight:bold">if</span> (policy.Date <span style="color:#6ab825;font-weight:bold">is</span> { } when)
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                <span style="color:#6ab825;font-weight:bold">if</span> (text.Length &gt; <span style="color:#3677a9">0</span>)
</span></span><span style="display:flex;"><span>                {
</span></span><span style="display:flex;"><span>                    text.Append(<span style="color:#ed9d13">&#39; &#39;</span>);
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                text.Append(<span style="color:#ed9d13">&#34;The API will be sunset on &#34;</span>)
</span></span><span style="display:flex;"><span>                    .Append(when.Date.ToShortDateString())
</span></span><span style="display:flex;"><span>                    .Append(<span style="color:#ed9d13">&#39;.&#39;</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#6ab825;font-weight:bold">if</span> (policy.HasLinks)
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                text.AppendLine();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#6ab825;font-weight:bold">var</span> rendered = <span style="color:#6ab825;font-weight:bold">false</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#6ab825;font-weight:bold">foreach</span> (<span style="color:#6ab825;font-weight:bold">var</span> link <span style="color:#6ab825;font-weight:bold">in</span> policy.Links.Where(l =&gt; l.Type == <span style="color:#ed9d13">&#34;text/html&#34;</span>))
</span></span><span style="display:flex;"><span>                {
</span></span><span style="display:flex;"><span>                    <span style="color:#6ab825;font-weight:bold">if</span> (!rendered)
</span></span><span style="display:flex;"><span>                    {
</span></span><span style="display:flex;"><span>                        text.Append(<span style="color:#ed9d13">&#34;&lt;h4&gt;Links&lt;/h4&gt;&lt;ul&gt;&#34;</span>);
</span></span><span style="display:flex;"><span>                        rendered = <span style="color:#6ab825;font-weight:bold">true</span>;
</span></span><span style="display:flex;"><span>                    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                    text.Append(<span style="color:#ed9d13">&#34;&lt;li&gt;&lt;a href=\&#34;&#34;</span>);
</span></span><span style="display:flex;"><span>                    text.Append(link.LinkTarget.OriginalString);
</span></span><span style="display:flex;"><span>                    text.Append(<span style="color:#ed9d13">&#34;\&#34;&gt;&#34;</span>);
</span></span><span style="display:flex;"><span>                    text.Append(
</span></span><span style="display:flex;"><span>                        StringSegment.IsNullOrEmpty(link.Title)
</span></span><span style="display:flex;"><span>                        ? link.LinkTarget.OriginalString
</span></span><span style="display:flex;"><span>                        : link.Title.ToString());
</span></span><span style="display:flex;"><span>                    text.Append(<span style="color:#ed9d13">&#34;&lt;/a&gt;&lt;/li&gt;&#34;</span>);
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#6ab825;font-weight:bold">if</span> (rendered)
</span></span><span style="display:flex;"><span>                {
</span></span><span style="display:flex;"><span>                    text.Append(<span style="color:#ed9d13">&#34;&lt;/ul&gt;&#34;</span>);
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">return</span> text.ToString();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#6ab825;font-weight:bold">static</span> OpenApiOptions ApplySecuritySchemeDefinitions(<span style="color:#6ab825;font-weight:bold">this</span> OpenApiOptions options)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        options.AddDocumentTransformer&lt;SecuritySchemeDefinitionsTransformer&gt;();
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">return</span> options;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#6ab825;font-weight:bold">static</span> OpenApiOptions ApplyAuthorizationChecks(<span style="color:#6ab825;font-weight:bold">this</span> OpenApiOptions options, <span style="color:#6ab825;font-weight:bold">string</span>[] scopes)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        options.AddOperationTransformer((operation, context, cancellationToken) =&gt;
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#6ab825;font-weight:bold">var</span> metadata = context.Description.ActionDescriptor.EndpointMetadata;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#6ab825;font-weight:bold">if</span> (!metadata.OfType&lt;IAuthorizeData&gt;().Any())
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                <span style="color:#6ab825;font-weight:bold">return</span> Task.CompletedTask;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            operation.Responses.TryAdd(<span style="color:#ed9d13">&#34;401&#34;</span>, <span style="color:#6ab825;font-weight:bold">new</span> OpenApiResponse { Description = <span style="color:#ed9d13">&#34;Unauthorized&#34;</span> });
</span></span><span style="display:flex;"><span>            operation.Responses.TryAdd(<span style="color:#ed9d13">&#34;403&#34;</span>, <span style="color:#6ab825;font-weight:bold">new</span> OpenApiResponse { Description = <span style="color:#ed9d13">&#34;Forbidden&#34;</span> });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#6ab825;font-weight:bold">var</span> oAuthScheme = <span style="color:#6ab825;font-weight:bold">new</span> OpenApiSecurityScheme
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                Reference = <span style="color:#6ab825;font-weight:bold">new</span> OpenApiReference { Type = ReferenceType.SecurityScheme, Id = <span style="color:#ed9d13">&#34;oauth2&#34;</span> }
</span></span><span style="display:flex;"><span>            };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            operation.Security = <span style="color:#6ab825;font-weight:bold">new</span> List&lt;OpenApiSecurityRequirement&gt;
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                <span style="color:#6ab825;font-weight:bold">new</span>()
</span></span><span style="display:flex;"><span>                {
</span></span><span style="display:flex;"><span><span style="color:#bbb">                    [oAuthScheme]</span> = scopes
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#6ab825;font-weight:bold">return</span> Task.CompletedTask;
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">return</span> options;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#6ab825;font-weight:bold">static</span> OpenApiOptions ApplyOperationDeprecatedStatus(<span style="color:#6ab825;font-weight:bold">this</span> OpenApiOptions options)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        options.AddOperationTransformer((operation, context, cancellationToken) =&gt;
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#6ab825;font-weight:bold">var</span> apiDescription = context.Description;
</span></span><span style="display:flex;"><span>            operation.Deprecated |= apiDescription.IsDeprecated();
</span></span><span style="display:flex;"><span>            <span style="color:#6ab825;font-weight:bold">return</span> Task.CompletedTask;
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">return</span> options;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#6ab825;font-weight:bold">static</span> OpenApiOptions ApplyApiVersionDescription(<span style="color:#6ab825;font-weight:bold">this</span> OpenApiOptions options)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        options.AddOperationTransformer((operation, context, cancellationToken) =&gt;
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#999;font-style:italic">// Find parameter named &#34;api-version&#34; and add a description to it</span>
</span></span><span style="display:flex;"><span>            <span style="color:#6ab825;font-weight:bold">var</span> apiVersionParameter = operation.Parameters.FirstOrDefault(p =&gt; p.Name == <span style="color:#ed9d13">&#34;api-version&#34;</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#6ab825;font-weight:bold">if</span> (apiVersionParameter <span style="color:#6ab825;font-weight:bold">is</span> not <span style="color:#6ab825;font-weight:bold">null</span>) {
</span></span><span style="display:flex;"><span>                apiVersionParameter.Description = <span style="color:#ed9d13">&#34;The API version, in the format &#39;major.minor&#39;.&#34;</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#6ab825;font-weight:bold">var</span> versionNumber = context.DocumentName.TrimStart(<span style="color:#ed9d13">&#39;v&#39;</span>);
</span></span><span style="display:flex;"><span>                <span style="color:#6ab825;font-weight:bold">if</span> (<span style="color:#6ab825;font-weight:bold">int</span>.TryParse(versionNumber, <span style="color:#6ab825;font-weight:bold">out</span> <span style="color:#6ab825;font-weight:bold">var</span> version)) {
</span></span><span style="display:flex;"><span>                    apiVersionParameter.Schema.Example = <span style="color:#6ab825;font-weight:bold">new</span> OpenApiString(<span style="color:#ed9d13">$&#34;{version}.0&#34;</span>);
</span></span><span style="display:flex;"><span>                } <span style="color:#6ab825;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>                    <span style="color:#6ab825;font-weight:bold">throw</span> <span style="color:#6ab825;font-weight:bold">new</span> ArgumentException(<span style="color:#ed9d13">&#34;got invalid document name {context.DocumentName}. Expected format v#&#34;</span>);
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#6ab825;font-weight:bold">return</span> Task.CompletedTask;
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">return</span> options;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#999;font-style:italic">// This extension method adds a schema transformer that sets &#34;nullable&#34; to false for all optional properties.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#6ab825;font-weight:bold">static</span> OpenApiOptions ApplySchemaNullableFalse(<span style="color:#6ab825;font-weight:bold">this</span> OpenApiOptions options)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        options.AddSchemaTransformer((schema, context, cancellationToken) =&gt;
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#6ab825;font-weight:bold">if</span> (schema.Properties <span style="color:#6ab825;font-weight:bold">is</span> not <span style="color:#6ab825;font-weight:bold">null</span>)
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                <span style="color:#6ab825;font-weight:bold">foreach</span> (<span style="color:#6ab825;font-weight:bold">var</span> property <span style="color:#6ab825;font-weight:bold">in</span> schema.Properties)
</span></span><span style="display:flex;"><span>                {
</span></span><span style="display:flex;"><span>                    <span style="color:#6ab825;font-weight:bold">if</span> (schema.Required?.Contains(property.Key) != <span style="color:#6ab825;font-weight:bold">true</span>)
</span></span><span style="display:flex;"><span>                    {
</span></span><span style="display:flex;"><span>                        property.Value.Nullable = <span style="color:#6ab825;font-weight:bold">false</span>;
</span></span><span style="display:flex;"><span>                    }
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#6ab825;font-weight:bold">return</span> Task.CompletedTask;
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">return</span> options;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#cd2828;font-weight:bold">#pragma</span> warning disable <span style="color:#3677a9">9113</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">private</span> <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#447fcf;text-decoration:underline">SecuritySchemeDefinitionsTransformer</span>(IConfiguration configuration) : IOpenApiDocumentTransformer {
</span></span><span style="display:flex;"><span><span style="color:#cd2828;font-weight:bold">#pragma</span> warning restore <span style="color:#3677a9">9113</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">public</span> Task TransformAsync(OpenApiDocument document, OpenApiDocumentTransformerContext context, CancellationToken cancellationToken) {
</span></span><span style="display:flex;"><span>            document.Components ??= <span style="color:#6ab825;font-weight:bold">new</span>();
</span></span><span style="display:flex;"><span>            document.Components.SecuritySchemes.Add(<span style="color:#ed9d13">&#34;Bearer&#34;</span>, <span style="color:#6ab825;font-weight:bold">new</span> OpenApiSecurityScheme {
</span></span><span style="display:flex;"><span>                In = ParameterLocation.Header,
</span></span><span style="display:flex;"><span>                Description = <span style="color:#ed9d13">&#34;Please enter a valid token&#34;</span>,
</span></span><span style="display:flex;"><span>                Name = <span style="color:#ed9d13">&#34;Authorization&#34;</span>,
</span></span><span style="display:flex;"><span>                Type = SecuritySchemeType.Http,
</span></span><span style="display:flex;"><span>                BearerFormat = <span style="color:#ed9d13">&#34;JWT&#34;</span>,
</span></span><span style="display:flex;"><span>                Scheme = <span style="color:#ed9d13">&#34;Bearer&#34;</span>
</span></span><span style="display:flex;"><span>            });
</span></span><span style="display:flex;"><span>            <span style="color:#6ab825;font-weight:bold">return</span> Task.CompletedTask;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></details>
<details><summary>Program.cs</summary>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cs" data-lang="cs"><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">var</span> apiVersioning = builder.Services.AddApiVersioning(options =&gt; {
</span></span><span style="display:flex;"><span>                options.DefaultApiVersion = <span style="color:#6ab825;font-weight:bold">new</span> ApiVersion(<span style="color:#3677a9">1</span>, <span style="color:#3677a9">0</span>);
</span></span><span style="display:flex;"><span>                options.AssumeDefaultVersionWhenUnspecified = <span style="color:#6ab825;font-weight:bold">true</span>;
</span></span><span style="display:flex;"><span>                options.ApiVersionReader = <span style="color:#6ab825;font-weight:bold">new</span> HeaderApiVersionReader(<span style="color:#ed9d13">&#34;x-ms-version&#34;</span>);
</span></span><span style="display:flex;"><span>                options.ReportApiVersions = <span style="color:#6ab825;font-weight:bold">true</span>;
</span></span><span style="display:flex;"><span>                options.UnsupportedApiVersionStatusCode = <span style="color:#3677a9">501</span>;
</span></span><span style="display:flex;"><span>            });
</span></span><span style="display:flex;"><span>    builder.AddDefaultOpenApi(apiVersioning);
</span></span><span style="display:flex;"><span>    builder.Services.AddSingleton&lt;IAuthorizationMiddlewareResultHandler, Show404AuthorizationMiddlewareResultHandler&gt;();
</span></span><span style="display:flex;"><span>    builder.Services.AddAuthorizationBuilder()
</span></span><span style="display:flex;"><span>                .AddPolicy(<span style="color:#ed9d13">&#34;ApiDeveloperPolicy&#34;</span>, policy =&gt; policy.RequireRole([<span style="color:#ed9d13">&#34;developer&#34;</span>])
</span></span><span style="display:flex;"><span>                .AddRequirements(<span style="color:#6ab825;font-weight:bold">new</span> ProtectedEndpoint404()));
</span></span><span style="display:flex;"><span>    <span style="color:#999;font-style:italic">// after app.MapControllers().WithStaticAssets();</span>
</span></span><span style="display:flex;"><span>    app.UseDefaultOpenApi();
</span></span></code></pre></div></details>
<details><summary> ProgramAuxiliary</summary>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cs" data-lang="cs"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#447fcf;text-decoration:underline">Show404AuthorizationMiddlewareResultHandler</span> : IAuthorizationMiddlewareResultHandler {
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">private</span> <span style="color:#6ab825;font-weight:bold">readonly</span> AuthorizationMiddlewareResultHandler defaultHandler = <span style="color:#6ab825;font-weight:bold">new</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#6ab825;font-weight:bold">async</span> Task HandleAsync(
</span></span><span style="display:flex;"><span>        RequestDelegate next,
</span></span><span style="display:flex;"><span>        HttpContext context,
</span></span><span style="display:flex;"><span>        AuthorizationPolicy policy,
</span></span><span style="display:flex;"><span>        PolicyAuthorizationResult authorizeResult) {
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">if</span> (!authorizeResult.Succeeded &amp;&amp; policy.Requirements.Any(p =&gt; p <span style="color:#6ab825;font-weight:bold">is</span> ProtectedEndpoint404)) {
</span></span><span style="display:flex;"><span>            <span style="color:#999;font-style:italic">// Return a 404 to make it appear as if the resource doesn&#39;t exist.</span>
</span></span><span style="display:flex;"><span>            context.Response.StatusCode = StatusCodes.Status404NotFound;
</span></span><span style="display:flex;"><span>            <span style="color:#6ab825;font-weight:bold">return</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">await</span> defaultHandler.HandleAsync(next, context, policy, authorizeResult);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#447fcf;text-decoration:underline">ProtectedEndpoint404</span> : IAuthorizationRequirement { }
</span></span></code></pre></div></details>
<details><summary>csproj Partial - Packages</summary>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">&lt;ItemGroup&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">&lt;PackageReference</span> <span style="color:#bbb">Include=</span><span style="color:#ed9d13">&#34;Asp.Versioning.Http&#34;</span> <span style="color:#bbb">Version=</span><span style="color:#ed9d13">&#34;8.1.0&#34;</span> <span style="color:#6ab825;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">&lt;PackageReference</span> <span style="color:#bbb">Include=</span><span style="color:#ed9d13">&#34;Asp.Versioning.Http.Client&#34;</span> <span style="color:#bbb">Version=</span><span style="color:#ed9d13">&#34;8.1.0&#34;</span> <span style="color:#6ab825;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">&lt;PackageReference</span> <span style="color:#bbb">Include=</span><span style="color:#ed9d13">&#34;Asp.Versioning.Mvc.ApiExplorer&#34;</span> <span style="color:#bbb">Version=</span><span style="color:#ed9d13">&#34;8.1.0&#34;</span> <span style="color:#6ab825;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">&lt;PackageReference</span> <span style="color:#bbb">Include=</span><span style="color:#ed9d13">&#34;Microsoft.AspNet.WebApi.Client&#34;</span> <span style="color:#bbb">Version=</span><span style="color:#ed9d13">&#34;6.0.0&#34;</span> <span style="color:#6ab825;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">&lt;PackageReference</span> <span style="color:#bbb">Include=</span><span style="color:#ed9d13">&#34;Microsoft.AspNetCore.Authentication.JwtBearer&#34;</span> <span style="color:#bbb">Version=</span><span style="color:#ed9d13">&#34;9.0.1&#34;</span> <span style="color:#6ab825;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">&lt;PackageReference</span> <span style="color:#bbb">Include=</span><span style="color:#ed9d13">&#34;Microsoft.AspNetCore.Mvc.Testing&#34;</span> <span style="color:#bbb">Version=</span><span style="color:#ed9d13">&#34;9.0.1&#34;</span> <span style="color:#6ab825;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">&lt;PackageReference</span> <span style="color:#bbb">Include=</span><span style="color:#ed9d13">&#34;Microsoft.AspNetCore.OpenApi&#34;</span> <span style="color:#bbb">Version=</span><span style="color:#ed9d13">&#34;9.0.1&#34;</span> <span style="color:#6ab825;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">&lt;PackageReference</span> <span style="color:#bbb">Include=</span><span style="color:#ed9d13">&#34;Microsoft.Azure.AppConfiguration.AspNetCore&#34;</span> <span style="color:#bbb">Version=</span><span style="color:#ed9d13">&#34;8.0.0&#34;</span> <span style="color:#6ab825;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">&lt;PackageReference</span> <span style="color:#bbb">Include=</span><span style="color:#ed9d13">&#34;Microsoft.Extensions.ApiDescription.Server&#34;</span> <span style="color:#bbb">Version=</span><span style="color:#ed9d13">&#34;9.0.1&#34;</span><span style="color:#6ab825;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#6ab825;font-weight:bold">&lt;IncludeAssets&gt;</span>runtime; build; native; contentfiles; analyzers; buildtransitive<span style="color:#6ab825;font-weight:bold">&lt;/IncludeAssets&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#6ab825;font-weight:bold">&lt;PrivateAssets&gt;</span>all<span style="color:#6ab825;font-weight:bold">&lt;/PrivateAssets&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">&lt;/PackageReference&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">&lt;PackageReference</span> <span style="color:#bbb">Include=</span><span style="color:#ed9d13">&#34;Microsoft.Extensions.Configuration.Binder&#34;</span> <span style="color:#bbb">Version=</span><span style="color:#ed9d13">&#34;9.0.1&#34;</span> <span style="color:#6ab825;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">&lt;PackageReference</span> <span style="color:#bbb">Include=</span><span style="color:#ed9d13">&#34;Microsoft.FeatureManagement.AspNetCore&#34;</span> <span style="color:#bbb">Version=</span><span style="color:#ed9d13">&#34;4.0.0&#34;</span> <span style="color:#6ab825;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">&lt;PackageReference</span> <span style="color:#bbb">Include=</span><span style="color:#ed9d13">&#34;Microsoft.IdentityModel.Tokens&#34;</span> <span style="color:#bbb">Version=</span><span style="color:#ed9d13">&#34;8.3.1&#34;</span> <span style="color:#6ab825;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">&lt;PackageReference</span> <span style="color:#bbb">Include=</span><span style="color:#ed9d13">&#34;Microsoft.VisualStudio.Azure.Containers.Tools.Targets&#34;</span> <span style="color:#bbb">Version=</span><span style="color:#ed9d13">&#34;1.21.0&#34;</span> <span style="color:#6ab825;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">&lt;PackageReference</span> <span style="color:#bbb">Include=</span><span style="color:#ed9d13">&#34;MongoDB.Analyzer&#34;</span> <span style="color:#bbb">Version=</span><span style="color:#ed9d13">&#34;1.5.0&#34;</span> <span style="color:#6ab825;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">&lt;PackageReference</span> <span style="color:#bbb">Include=</span><span style="color:#ed9d13">&#34;MongoDB.Driver&#34;</span> <span style="color:#bbb">Version=</span><span style="color:#ed9d13">&#34;3.1.0&#34;</span> <span style="color:#6ab825;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">&lt;PackageReference</span> <span style="color:#bbb">Include=</span><span style="color:#ed9d13">&#34;Postmark&#34;</span> <span style="color:#bbb">Version=</span><span style="color:#ed9d13">&#34;5.2.0&#34;</span> <span style="color:#6ab825;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">&lt;PackageReference</span> <span style="color:#bbb">Include=</span><span style="color:#ed9d13">&#34;Scalar.AspNetCore&#34;</span> <span style="color:#bbb">Version=</span><span style="color:#ed9d13">&#34;2.0.9&#34;</span> <span style="color:#6ab825;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">&lt;PackageReference</span> <span style="color:#bbb">Include=</span><span style="color:#ed9d13">&#34;Stripe.net&#34;</span> <span style="color:#bbb">Version=</span><span style="color:#ed9d13">&#34;47.3.0&#34;</span> <span style="color:#6ab825;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">&lt;PackageReference</span> <span style="color:#bbb">Include=</span><span style="color:#ed9d13">&#34;Swashbuckle.AspNetCore&#34;</span> <span style="color:#bbb">Version=</span><span style="color:#ed9d13">&#34;7.2.0&#34;</span> <span style="color:#6ab825;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">&lt;PackageReference</span> <span style="color:#bbb">Include=</span><span style="color:#ed9d13">&#34;System.IdentityModel.Tokens.Jwt&#34;</span> <span style="color:#bbb">Version=</span><span style="color:#ed9d13">&#34;8.3.1&#34;</span> <span style="color:#6ab825;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">&lt;PackageReference</span> <span style="color:#bbb">Include=</span><span style="color:#ed9d13">&#34;System.Text.Json&#34;</span> <span style="color:#bbb">Version=</span><span style="color:#ed9d13">&#34;9.0.1&#34;</span> <span style="color:#6ab825;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#6ab825;font-weight:bold">&lt;/ItemGroup&gt;</span>
</span></span></code></pre></div></details>
<h2 id="net-8-versioning" >.NET 8 Versioning
<span>
    <a href="#net-8-versioning">
        <svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
    </a>
</span>
</h2><h3 id="programcs" >Program.cs
<span>
    <a href="#programcs">
        <svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
    </a>
</span>
</h3><p>Note that by default, ASP.NET will set each route as version 1 unless otherwise defined. Also note that if a client does not specify a version, the version 1 route will be used by default.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cs" data-lang="cs"><span style="display:flex;"><span>builder.Services.AddApiVersioning(options =&gt; {
</span></span><span style="display:flex;"><span>    options.DefaultApiVersion = <span style="color:#6ab825;font-weight:bold">new</span> ApiVersion(<span style="color:#3677a9">1</span>, <span style="color:#3677a9">0</span>);
</span></span><span style="display:flex;"><span>    options.AssumeDefaultVersionWhenUnspecified = <span style="color:#6ab825;font-weight:bold">true</span>;
</span></span><span style="display:flex;"><span>    options.ApiVersionReader = <span style="color:#6ab825;font-weight:bold">new</span> HeaderApiVersionReader(<span style="color:#ed9d13">&#34;x-ms-version&#34;</span>);
</span></span><span style="display:flex;"><span>    options.ReportApiVersions = <span style="color:#6ab825;font-weight:bold">true</span>;
</span></span><span style="display:flex;"><span>    options.UnsupportedApiVersionStatusCode = <span style="color:#3677a9">501</span>;
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic">// format the version as &#34;&#39;v&#39;major[.minor][-status]&#34;</span>
</span></span><span style="display:flex;"><span>.AddApiExplorer(options =&gt; {
</span></span><span style="display:flex;"><span>    options.GroupNameFormat = <span style="color:#ed9d13">&#34;&#39;v&#39;VVV&#34;</span>;
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><h3 id="programauxiliarycs" >ProgramAuxiliary.cs
<span>
    <a href="#programauxiliarycs">
        <svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
    </a>
</span>
</h3><p>The following code allows the Swagger UI to work with the versioning.</p>
<p>Some of this code might be unused, this is because in my own <code>ProgramAuxiliary.cs</code>, I also have the code to enable <a href="/posts/aspnet-kebab-case-routes/">kebab case routes</a>.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cs" data-lang="cs"><span style="display:flex;"><span><span style="color:#999;font-style:italic">// ProgramAuxiliary.cs is a supplementary to the startup code in Program.cs where this file contains some boilerplate to provide abstraction</span>
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">using</span> <span style="color:#447fcf;text-decoration:underline">Asp.Versioning.ApiExplorer</span>;
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">using</span> <span style="color:#447fcf;text-decoration:underline">Microsoft.AspNetCore.Mvc.ApiExplorer</span>;
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">using</span> <span style="color:#447fcf;text-decoration:underline">Microsoft.AspNetCore.Mvc.ModelBinding</span>;
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">using</span> <span style="color:#447fcf;text-decoration:underline">Microsoft.Extensions.Options</span>;
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">using</span> <span style="color:#447fcf;text-decoration:underline">Microsoft.OpenApi.Models</span>;
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">using</span> <span style="color:#447fcf;text-decoration:underline">Swashbuckle.AspNetCore.SwaggerGen</span>;
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">using</span> <span style="color:#447fcf;text-decoration:underline">System.Text.Json</span>;
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">using</span> <span style="color:#447fcf;text-decoration:underline">System.Text.RegularExpressions</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">namespace</span> <span style="color:#447fcf;text-decoration:underline">SttApi</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic">// all I know is that this is related to making swagger work with different versions of the API</span>
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#447fcf;text-decoration:underline">ConfigureSwaggerOptions</span>(IApiVersionDescriptionProvider provider) : IConfigureOptions&lt;SwaggerGenOptions&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">readonly</span> IApiVersionDescriptionProvider _provider = provider;
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">readonly</span> <span style="color:#6ab825;font-weight:bold">string</span> _apiName = <span style="color:#ed9d13">&#34;Split The Tank&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#6ab825;font-weight:bold">void</span> Configure(SwaggerGenOptions options) {
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">foreach</span> (<span style="color:#6ab825;font-weight:bold">var</span> description <span style="color:#6ab825;font-weight:bold">in</span> _provider.ApiVersionDescriptions) {
</span></span><span style="display:flex;"><span>            options.SwaggerDoc(
</span></span><span style="display:flex;"><span>              description.GroupName,
</span></span><span style="display:flex;"><span>                <span style="color:#6ab825;font-weight:bold">new</span> OpenApiInfo() {
</span></span><span style="display:flex;"><span>                    Title = <span style="color:#ed9d13">$&#34;{_apiName} API {description.ApiVersion}&#34;</span>,
</span></span><span style="display:flex;"><span>                    Version = description.ApiVersion.ToString(),
</span></span><span style="display:flex;"><span>                });
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic">// All I know is that this bunch of code is related to making sure the API version is set in the header by default</span>
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#447fcf;text-decoration:underline">SwaggerDefaultValues</span> : IOperationFilter {
</span></span><span style="display:flex;"><span>    <span style="color:#e50808;background-color:#520000;font-weight:bold">/// &lt;inheritdoc /&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#6ab825;font-weight:bold">void</span> Apply(OpenApiOperation operation, OperationFilterContext context) {
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">var</span> apiDescription = context.ApiDescription;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        operation.Deprecated |= apiDescription.IsDeprecated();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#999;font-style:italic">// REF: https://github.com/domaindrivendev/Swashbuckle.AspNetCore/issues/1752#issue-663991077</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">foreach</span> (<span style="color:#6ab825;font-weight:bold">var</span> responseType <span style="color:#6ab825;font-weight:bold">in</span> context.ApiDescription.SupportedResponseTypes) {
</span></span><span style="display:flex;"><span>            <span style="color:#999;font-style:italic">// REF: https://github.com/domaindrivendev/Swashbuckle.AspNetCore/blob/b7cf75e7905050305b115dd96640ddd6e74c7ac9/src/Swashbuckle.AspNetCore.SwaggerGen/SwaggerGenerator/SwaggerGenerator.cs#L383-L387</span>
</span></span><span style="display:flex;"><span>            <span style="color:#6ab825;font-weight:bold">var</span> responseKey = responseType.IsDefaultResponse ? <span style="color:#ed9d13">&#34;default&#34;</span> : responseType.StatusCode.ToString();
</span></span><span style="display:flex;"><span>            <span style="color:#6ab825;font-weight:bold">var</span> response = operation.Responses[responseKey];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#6ab825;font-weight:bold">foreach</span> (<span style="color:#6ab825;font-weight:bold">var</span> contentType <span style="color:#6ab825;font-weight:bold">in</span> response.Content.Keys) {
</span></span><span style="display:flex;"><span>                <span style="color:#6ab825;font-weight:bold">if</span> (!responseType.ApiResponseFormats.Any(x =&gt; x.MediaType == contentType)) {
</span></span><span style="display:flex;"><span>                    response.Content.Remove(contentType);
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">if</span> (operation.Parameters == <span style="color:#6ab825;font-weight:bold">null</span>) <span style="color:#6ab825;font-weight:bold">return</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#999;font-style:italic">// REF: https://github.com/domaindrivendev/Swashbuckle.AspNetCore/issues/412</span>
</span></span><span style="display:flex;"><span>        <span style="color:#999;font-style:italic">// REF: https://github.com/domaindrivendev/Swashbuckle.AspNetCore/pull/413</span>
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">foreach</span> (<span style="color:#6ab825;font-weight:bold">var</span> parameter <span style="color:#6ab825;font-weight:bold">in</span> operation.Parameters) {
</span></span><span style="display:flex;"><span>            <span style="color:#6ab825;font-weight:bold">var</span> description = apiDescription.ParameterDescriptions.First(p =&gt; p.Name == parameter.Name);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            parameter.Description ??= description.ModelMetadata?.Description;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#6ab825;font-weight:bold">if</span> (parameter.Schema.Default == <span style="color:#6ab825;font-weight:bold">null</span> &amp;&amp; description.DefaultValue != <span style="color:#6ab825;font-weight:bold">null</span> &amp;&amp;
</span></span><span style="display:flex;"><span>                 description.DefaultValue <span style="color:#6ab825;font-weight:bold">is</span> not DBNull &amp;&amp; description.ModelMetadata <span style="color:#6ab825;font-weight:bold">is</span> ModelMetadata modelMetadata) {
</span></span><span style="display:flex;"><span>                <span style="color:#999;font-style:italic">// REF: https://github.com/Microsoft/aspnet-api-versioning/issues/429#issuecomment-605402330</span>
</span></span><span style="display:flex;"><span>                <span style="color:#6ab825;font-weight:bold">var</span> json = JsonSerializer.Serialize(description.DefaultValue, modelMetadata.ModelType);
</span></span><span style="display:flex;"><span>                parameter.Schema.Default = OpenApiAnyFactory.CreateFromJson(json);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            parameter.Required |= description.IsRequired;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="controller-example" >Controller Example
<span>
    <a href="#controller-example">
        <svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
    </a>
</span>
</h3><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cs" data-lang="cs"><span style="display:flex;"><span><span style="color:#bbb">[Route(&#34;[controller]</span>/[action]<span style="color:#ed9d13">&#34;)]
</span></span></span><span style="display:flex;"><span><span style="color:#ed9d13"></span><span style="color:#bbb">[ApiController]</span>
</span></span><span style="display:flex;"><span><span style="color:#bbb">[Authorize]</span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic">// since we are defining a version 2, we want to inform ASP.NET that the other routes are version 1, you can experiment without this at first just to see the result</span>
</span></span><span style="display:flex;"><span><span style="color:#bbb">[ApiVersion(1.0)]</span>
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#447fcf;text-decoration:underline">PaymentController</span> : ControllerBase {
</span></span><span style="display:flex;"><span>  <span style="color:#999;font-style:italic">// this is Version 1</span>
</span></span><span style="display:flex;"><span><span style="color:#bbb">  [HttpGet]</span>
</span></span><span style="display:flex;"><span>  <span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#6ab825;font-weight:bold">async</span> Task&lt;ActionResult&lt;<span style="color:#6ab825;font-weight:bold">string</span>&gt;&gt; Invoice(<span style="color:#6ab825;font-weight:bold">string</span> payee) {
</span></span><span style="display:flex;"><span>      <span style="color:#999;font-style:italic">// implementation omitted</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  [HttpGet]</span>
</span></span><span style="display:flex;"><span><span style="color:#bbb">  [ApiVersion(2.0)]</span>
</span></span><span style="display:flex;"><span><span style="color:#bbb">  [ActionName(nameof(Invoice))]</span>
</span></span><span style="display:flex;"><span>  <span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#6ab825;font-weight:bold">async</span> Task&lt;ActionResult&lt;PaymentSheetProps&gt;&gt; InvoiceV2(<span style="color:#6ab825;font-weight:bold">string</span> payee) {
</span></span><span style="display:flex;"><span>      <span style="color:#999;font-style:italic">// implementation omitted</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cs" data-lang="cs"><span style="display:flex;"><span><span style="color:#999;font-style:italic">// gate-keep entire API to reduce possibility of unofficial clients</span>
</span></span><span style="display:flex;"><span><span style="color:#bbb">[Route(&#34;[controller]</span>/[action]<span style="color:#ed9d13">&#34;)]
</span></span></span><span style="display:flex;"><span><span style="color:#ed9d13"></span><span style="color:#bbb">[ApiController]</span>
</span></span><span style="display:flex;"><span><span style="color:#bbb">[Authorize]</span>
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#447fcf;text-decoration:underline">CarsController</span> : Controller {
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">private</span> <span style="color:#6ab825;font-weight:bold">readonly</span> CarService _carService;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">public</span> CarsController(CarService carService) {
</span></span><span style="display:flex;"><span>        _carService = carService;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#999;font-style:italic">// this is implicitly Version 1</span>
</span></span><span style="display:flex;"><span><span style="color:#bbb">    [HttpGet]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#6ab825;font-weight:bold">async</span> Task&lt;List&lt;OwnedCar&gt;&gt; Owned() {
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">var</span> cars = <span style="color:#6ab825;font-weight:bold">await</span> _carService.GetOwned(User.FindFirstValue(ClaimTypes.Email)!);
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">return</span> cars!;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="client-example" >Client Example
<span>
    <a href="#client-example">
        <svg viewBox="0 0 28 23" height="100%" width="19" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" fill="none" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/></svg>
    </a>
</span>
</h3><p>In the future, I will provide samples in Kotlin and Swift as well. For now, here&rsquo;s a JS implementation. Just use an LLM to get code for the language of the client you are writing.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#999;font-style:italic">// note that jwtFetch is just a wrapper around fetch that does auto logging out and .json() conversion when applicable
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span><span style="color:#6ab825;font-weight:bold">export</span> <span style="color:#6ab825;font-weight:bold">async</span> <span style="color:#6ab825;font-weight:bold">function</span> paymentInvoice(jwt, logout, payee) {
</span></span><span style="display:flex;"><span>  <span style="color:#6ab825;font-weight:bold">const</span> response = <span style="color:#6ab825;font-weight:bold">await</span> jwtFetch(<span style="color:#ed9d13">`payment/invoice?payee=</span><span style="color:#ed9d13">${</span>payee<span style="color:#ed9d13">}</span><span style="color:#ed9d13">`</span>, logout, {
</span></span><span style="display:flex;"><span>    method: <span style="color:#ed9d13">&#39;GET&#39;</span>,
</span></span><span style="display:flex;"><span>    headers: { ...buildAuthHeader(jwt), <span style="color:#ed9d13">&#39;x-ms-version&#39;</span>: <span style="color:#ed9d13">&#39;2.0&#39;</span> },
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>  <span style="color:#6ab825;font-weight:bold">return</span> response;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div>
        </div>
    </article>

    

    
        
    
    
    <div class="pagination post-pagination">
        <div class="left pagination-item ">
            
                <a title="Israel&rsquo;s Government is Anti-Peace and Anti-Palestine" href="/posts/israel-is-against-peace/">Israel&rsquo;s Government is Anti-Peace and Anti-Palestine</a>
            
        </div>
        <div class="right pagination-item ">
            
                <a title="Retail Investors Are Stupid" href="/posts/retail-investors-are-stupid/">Retail Investors Are Stupid</a>
            
        </div>
    </div>




    

    
        <br>







    





<script src="https://giscus.app/client.js"
        data-repo="elibroftw/blog.elijahlopez.ca"
        data-repo-id="R_kgDOGiL7hg"
        data-category="General"
        data-category-id="DIC_kwDOGiL7hs4Cer6e"
        data-mapping="og:title"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="preferred_color_scheme"
        data-lang="en"
        crossorigin="anonymous"
        
        async>
</script>

    

        </main>
        
            <footer class="common-footer">
    
    

    <div class="common-footer-bottom">
        
        <div class="copyright">
            <p> Elijah Lopez, 2025<br>
            Powered by <a target="_blank" rel="noopener noreferrer" href="https://gohugo.io/">Hugo</a>, theme <a target="_blank" rel="noopener noreferrer" href="https://github.com/elibroftw/hugo-theme-anubis">Anubis</a>.<br>
            
            </p>
        </div>
    </div>

    <p class="h-card vcard">

    <a href=https://blog.elijahlopez.ca/ class="p-name u-url url fn" rel="me">Elijah Lopez</a> 

     
        /
        <a class="p-email u-email email" rel="me" href="mailto:elijahllopezz@gmail.com">elijahllopezz@gmail.com</a>
    

     
        <img class="u-photo" src="https://pbs.twimg.com/profile_images/1738729591064166400/vqarzcF7_400x400.jpg" />
    
</p> 
</footer>

        
    </div>
</body>
</html>
